drop table SAL_INVOICE_BOOK;
--发票本管理
CREATE TABLE [SAL_INVOICE_BOOK] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --流水ID号
	[INVH_ID] [char] (36) NOT NULL ,
        --领用门店
	[SHOP_ID] [varchar] (13) NOT NULL ,
        --领用部门
	[DEPT_ID] [varchar] (12) NOT NULL ,
        --发票类型
	[INVOICE_FLAG] [varchar] (1) NULL ,
        --领用人
	[CREA_USER] varchar(36) NOT NULL ,
        --领用日期
	[CREA_DATE] int NOT NULL ,
        --备注
	[REMARK] [varchar] (100) NULL ,
        --发票代码
	[INVH_NO] [varchar] (50) NOT NULL ,
        --当前票号
	[CURRENT_NO] int NOT NULL ,
        --发票起始号
	[BEGIN_NO] int NOT NULL ,
        --发票终止号
	[ENDED_NO] int NOT NULL ,
        --合计张数
	[TOTAL_AMT] int NULL ,
        --开票张数
	[USING_AMT] int NULL ,
        --作废张数
	[CANCEL_AMT] int NULL ,
        --结余张数
	[BALANCE] int NULL ,
        --通讯标志
	[COMM] [varchar] (2) NOT NULL CONSTRAINT [DF_SAL_INVOICE_BOOK_COMM] DEFAULT ('00'),
        --时间戳 
  [TIME_STAMP] bigint NOT NULL,
	CONSTRAINT [PK_SAL_INVOICE_BOOK] PRIMARY KEY   
	(
		[TENANT_ID],[INVH_ID]
	) 
);

CREATE INDEX IX_SAL_INVOICE_BOOK_TENANT_ID ON SAL_INVOICE_BOOK(TENANT_ID);
CREATE INDEX IX_SAL_INVOICE_BOOK_TIME_STAMP ON SAL_INVOICE_BOOK(TENANT_ID,TIME_STAMP);
CREATE INDEX IX_SAL_INVOICE_BOOK_CREA_DATE ON SAL_INVOICE_BOOK(CREA_DATE);
CREATE INDEX IX_SAL_INVOICE_BOOK_SHOP_ID ON SAL_INVOICE_BOOK(TENANT_ID,SHOP_ID);


--代金券类型
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('1','赠券','VOUCHER_TYPE','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('2','现金券','VOUCHER_TYPE','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('3','记名券','VOUCHER_TYPE','00',5497000);

insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('1','入库','VOUCHER_STATUS','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('2','领用','VOUCHER_STATUS','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('3','发放','VOUCHER_STATUS','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('4','结算','VOUCHER_STATUS','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('5','回收','VOUCHER_STATUS','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('6','作废','VOUCHER_STATUS','00',5497000);

insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('0','不关联','LINK_FLAG','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('1','订货单','LINK_FLAG','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('2','销售单','LINK_FLAG','00',5497000);
insert into PUB_PARAMS(CODE_ID,CODE_NAME,TYPE_CODE,COMM,TIME_STAMP) values('3','退货单','LINK_FLAG','00',5497000);

--代金券入库
CREATE TABLE [SAL_VOUCHERORDER] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --入库单号
	[VOUCHER_ID] [char] (36) NOT NULL ,
        --入库门店
	[SHOP_ID] [varchar] (13) NOT NULL ,
        --入库部门
	[DEPT_ID] [varchar] (12) NOT NULL ,
        --代金券类型
	[VOUCHER_TYPE] [varchar] (1) NOT NULL ,
        --入库日期
	[INTO_DATE] int NOT NULL ,
        --负责人
	[INTO_USER] [varchar] (36) NULL ,
	
        --操作时间
	[CREA_DATE] [varchar] (30) NULL ,
        --操作人员
	[CREA_USER] [varchar] (36) NULL ,
        --备注
	[REMARK] [varchar] (100) NULL ,
        --通讯标志
	[COMM] [varchar] (2) NOT NULL CONSTRAINT [DF_SAL_VOUCHERORDER_COMM] DEFAULT ('00'),
        --时间戳 
  [TIME_STAMP] bigint NOT NULL,
	CONSTRAINT [PK_SAL_VOUCHERORDER] PRIMARY KEY   
	(
		[TENANT_ID],[VOUCHER_ID]
	) 
);

CREATE INDEX IX_SAL_VOUCHERORDER_TENANT_ID ON SAL_VOUCHERORDER(TENANT_ID);
CREATE INDEX IX_SAL_VOUCHERORDER_TIME_STAMP ON SAL_VOUCHERORDER(TENANT_ID,TIME_STAMP);
CREATE INDEX IX_SAL_VOUCHERORDER_INTO_DATE ON SAL_VOUCHERORDER(INTO_DATE);

--代金券档案
CREATE TABLE [SAL_VOUCHERDATA] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --入库单号
	[VOUCHER_ID] [char] (36) NOT NULL ,
        --防伪码
	[BARCODE] [varchar] (50) NOT NULL ,
        --代金券类型
	[VOUCHER_TYPE] [varchar] (1) NULL ,
        --面值
	[VOUCHER_PRC] int NOT NULL ,
        --状态
	[VOUCHER_STATUS] [char] (1) NOT NULL ,
        --有效期
	[VAILD_DATE] int NOT NULL ,
        --记名券时记在谁名下
	[CLIENT_ID] [varchar] (36) NOT NULL ,
        --通讯标志
	[COMM] [varchar] (2) NOT NULL CONSTRAINT [DF_SAL_VOUCHERDATA_COMM] DEFAULT ('00'),
        --时间戳 
  [TIME_STAMP] bigint NOT NULL,
	CONSTRAINT [PK_SAL_VOUCHERDATA] PRIMARY KEY   
	(
		[TENANT_ID],[BARCODE]
	) 
);

CREATE INDEX IX_SAL_VOUCHERDATA_TENANT_ID ON SAL_VOUCHERDATA(TENANT_ID);
CREATE INDEX IX_SAL_VOUCHERDATA_TIME_STAMP ON SAL_VOUCHERDATA(TENANT_ID,TIME_STAMP);
CREATE INDEX IX_SAL_VOUCHERDATA_VOUCHER_ID ON SAL_VOUCHERDATA(TENANT_ID,VOUCHER_ID);

--代金券领用
CREATE TABLE [SAL_VHLEADORDER] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --领用单号
	[VHLEAD_ID] [char] (36) NOT NULL ,
        --领用门店
	[SHOP_ID] [varchar] (13) NOT NULL ,
        --领用部门
	[DEPT_ID] [varchar] (12) NOT NULL ,
        --领用日期
	[LEAD_DATE] int NOT NULL ,
        --负责人
	[LEAD_USER] [varchar] (36) NULL ,
	
        --操作时间
	[CREA_DATE] [varchar] (30) NULL ,
        --操作人员
	[CREA_USER] [varchar] (36) NULL ,
        --备注
	[REMARK] [varchar] (100) NULL ,
        --通讯标志
	[COMM] [varchar] (2) NOT NULL CONSTRAINT [DF_SAL_VHLEADORDER_COMM] DEFAULT ('00'),
        --时间戳 
  [TIME_STAMP] bigint NOT NULL,
	CONSTRAINT [PK_SAL_VHLEADORDER] PRIMARY KEY   
	(
		[TENANT_ID],[VHLEAD_ID]
	) 
);

CREATE INDEX IX_SAL_VHLEADORDER_TENANT_ID ON SAL_VHLEADORDER(TENANT_ID);
CREATE INDEX IX_SAL_VHLEADORDER_TIME_STAMP ON SAL_VHLEADORDER(TENANT_ID,TIME_STAMP);
CREATE INDEX IX_SAL_VHLEADORDER_LEAD_DATE ON SAL_VHLEADORDER(LEAD_DATE);

--代金券领用
CREATE TABLE [SAL_VHLEADDATA] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --领用单号
	[VHLEAD_ID] [char] (36) NOT NULL ,
        --防伪码
	[BARCODE] [varchar] (50) NOT NULL ,
        --面值
	[VOUCHER_PRC] int NOT NULL ,
	CONSTRAINT [PK_SAL_VHLEADDATA] PRIMARY KEY   
	(
		[TENANT_ID],[VHLEAD_ID],[BARCODE]
	) 
);

CREATE INDEX IX_SAL_VHLEADDATA_TENANT_ID ON SAL_VHLEADDATA(TENANT_ID);
CREATE INDEX IX_SAL_VHLEADDATA_VHLEAD_ID ON SAL_VHLEADDATA(TENANT_ID,VHLEAD_ID);


--代金券发放
CREATE TABLE [SAL_VHSENDORDER] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --发放单号
	[VHSEND_ID] [char] (36) NOT NULL ,
        --发放门店
	[SHOP_ID] [varchar] (13) NOT NULL ,
        --发放部门
	[DEPT_ID] [varchar] (12) NOT NULL ,
        --客户
	[CLIENT_ID] [varchar] (36) NOT NULL ,
        --发放日期
	[SEND_DATE] int NOT NULL ,
        --负责人
	[SEND_USER] [varchar] (36) NULL ,
        --支付金额
	[VOUCHER_MNY] [decimal](18, 3) NULL ,
	
        --操作时间
	[CREA_DATE] [varchar] (30) NULL ,
        --操作人员
	[CREA_USER] [varchar] (36) NULL ,
        --备注
	[REMARK] [varchar] (100) NULL ,
        --通讯标志
	[COMM] [varchar] (2) NOT NULL CONSTRAINT [DF_SAL_VHSENDORDER_COMM] DEFAULT ('00'),
        --时间戳 
  [TIME_STAMP] bigint NOT NULL,
	CONSTRAINT [PK_SAL_VHSENDORDER] PRIMARY KEY   
	(
		[TENANT_ID],[VHSEND_ID]
	) 
);

CREATE INDEX IX_SAL_VHSENDORDER_TENANT_ID ON SAL_VHSENDORDER(TENANT_ID);
CREATE INDEX IX_SAL_VHSENDORDER_TIME_STAMP ON SAL_VHSENDORDER(TENANT_ID,TIME_STAMP);
CREATE INDEX IX_SAL_VHSENDORDER_SEND_DATE ON SAL_VHSENDORDER(SEND_DATE);

--代金券发放
CREATE TABLE [SAL_VHSENDDATA] (
        --企业代码
	[TENANT_ID] int NOT NULL ,
        --发放单号
	[VHSEND_ID] [char] (36) NOT NULL ,
        --防伪码
	[BARCODE] [varchar] (50) NOT NULL ,
        --面值
	[VOUCHER_PRC] int NOT NULL ,
        --代金券类型
	[VOUCHER_TYPE] [varchar] (1) NULL ,
        --支付金额
	[VOUCHER_MNY] [decimal](18, 3) NULL ,
        --折扣率
	[AGIO_RATE] [decimal](18, 3) NULL ,
        --折扣额
	[AGIO_MONEY] [decimal](18, 3) NULL ,
	CONSTRAINT [PK_SAL_VHLEADDATA] PRIMARY KEY   
	(
		[TENANT_ID],[VHSEND_ID],[BARCODE]
	) 
);

CREATE INDEX IX_SAL_VHSENDDATA_TENANT_ID ON SAL_VHSENDDATA(TENANT_ID);
CREATE INDEX IX_SAL_VHSENDDATA_VHSEND_ID ON SAL_VHSENDDATA(TENANT_ID,VHSEND_ID);
